EVE-NG Serial Telnet Bootstrapper
=================================
This python 3 script connects to a EVE-NG Pro Server, gathers node telnet connection details via the API, connects to each lab node's serial console over the telnet details, and then puts an initial configuration on the device allowing it to be further provisioned by another system. An ansible style ini file can be generated as well with the connectivity info gathered from the fxp0 interfaces. This script has been tested against vSRX firewalls running JUNOS 19.2R1.8.

Requirements
------------
Python 3.5+

Tested with Python 3.8

Python packages

* certifi==2020.4.5.1
* chardet==3.0.4
* idna==2.9
* requests==2.23.0
* urllib3==1.25.9

Virtualenv Install
----------
    python3.8 -m venv venv
    source venv/bin/activate
    pip install -r requirements.txt

Usage
---
The python script expects a few arguments. It is built using the argparse python library and has the default -h or --help option to display available parameters.

    python eveng_configure_nodes.py -h
    usage: eveng_configure_nodes.py [-h] [-u USER] [-p PASSWORD] [-r ROOT_PASSWORD] [-U LOCAL_USER] [-P LOCAL_PASS] [-s SILENT] eve_ip eve_lab
    positional arguments:
    eve_ip                The IP Address or hostname of the EVE-NG API
    eve_lab               The lab .unl name within EVE you want to bootstrap, include .unl in value
    optional arguments:
      -h, --help            show this help message and exit
      -u USER, --user USER  The API username to authenticate against EVE-NG API
      -p PASSWORD, --password PASSWORD
                            The API password to authenticate against EVE-NG API
      -r ROOT_PASSWORD, --root-password ROOT_PASSWORD
                            The password to use for the root account on the Juniper devices
      -U LOCAL_USER, --local-user LOCAL_USER
                            The local user account name on the Juniper devices
      -P LOCAL_PASS, --local-pass LOCAL_PASS
                            The local user password on the Juniper devices
      -s SILENT, --silent SILENT
                            This disables output to console, good for when launched with automation

Example
---
Python script execution example:
    python eveng_configure_nodes.py 10.1.99.138 BootStrapTesting.unl -u admin -p eve -r Password1 -U ansible -P Password1
    Connecting to device...
    Connected to vSRX1
    Waiting for login prompt...
    Logged in
    Configuring device...
    Waiting for configuration to be comitted...
    Waiting 30 seconds for fxp0 to get dhcp lease
    30 seconds remaining...
    29 seconds remaining...
    28 seconds remaining...
    27 seconds remaining...
    26 seconds remaining...
    25 seconds remaining...
    24 seconds remaining...
    23 seconds remaining...
    22 seconds remaining...
    21 seconds remaining...
    20 seconds remaining...
    19 seconds remaining...
    18 seconds remaining...
    17 seconds remaining...
    16 seconds remaining...
    15 seconds remaining...
    14 seconds remaining...
    13 seconds remaining...
    12 seconds remaining...
    11 seconds remaining...
    10 seconds remaining...
    9 seconds remaining...
    8 seconds remaining...
    7 seconds remaining...
    6 seconds remaining...
    5 seconds remaining...
    4 seconds remaining...
    3 seconds remaining...
    2 seconds remaining...
    1 seconds remaining...
    Closing connection to vSRX1
    Connecting to device...
    Connected to vSRX2
    Waiting for login prompt...
    Logged in
    Configuring device...
    Waiting for configuration to be comitted...
    Waiting 30 seconds for fxp0 to get dhcp lease
    30 seconds remaining...
    29 seconds remaining...
    28 seconds remaining...
    27 seconds remaining...
    26 seconds remaining...
    25 seconds remaining...
    24 seconds remaining...
    23 seconds remaining...
    22 seconds remaining...
    21 seconds remaining...
    20 seconds remaining...
    19 seconds remaining...
    18 seconds remaining...
    17 seconds remaining...
    16 seconds remaining...
    15 seconds remaining...
    14 seconds remaining...
    13 seconds remaining...
    12 seconds remaining...
    11 seconds remaining...
    10 seconds remaining...
    9 seconds remaining...
    8 seconds remaining...
    7 seconds remaining...
    6 seconds remaining...
    5 seconds remaining...
    4 seconds remaining...
    3 seconds remaining...
    2 seconds remaining...
    1 seconds remaining...
    Closing connection to vSRX2
    {'vSRX1': '10.1.99.149', 'vSRX2': '10.1.99.140'}

Caveats
---
The vSRX must be in a factory default state and the serial console must be completely logged out. This is due to the script using the low level socket library and expected specific prompts. If the serial console has been used but hasn't been logged out, then open the console and quit/exit all prompts until the "login:" prompt is shown.

Improvement
---
There are a few areas of improvements that could be done. The primary one would be multithreading/processing of the lab node connections. The slowest part of the script is waiting for each node individually to get a dhcp lease on their fxp0 interface.
